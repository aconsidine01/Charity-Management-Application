{"ast":null,"code":"var _jsxFileName = \"C:\\\\Project\\\\apiset2\\\\frontend\\\\src\\\\Login.js\";\nimport TopNavBar from './TopNavBar';\nimport React, { Component } from \"react\"; //import AddEmployee from \"./Components/AddEmployee\";\n//import { Route, BrowserRouter as Router } from \"react-router-dom\";\n\nimport { BrowserRouter, Router, Route, Switch, Redirect } from 'react-router-dom'; //import Table from \"./Components/Table\";\n//import App from './App';\n//import background from './charitybackground.jfif';\n\nimport ReactDOM from 'react-dom';\nimport Recipients from \"./Components/Recipients\";\nimport HomePageCharities from './Components/HomePageCharities';\nimport { Container } from 'react-bootstrap';\nimport Footer from './Footer';\nimport Home from './Home';\nimport Avatar from \"@material-ui/core/Avatar\";\nimport Button from \"@material-ui/core/Button\";\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\nimport TextField from \"@material-ui/core/TextField\";\nimport { Link } from \"react-router-dom\";\nimport Grid from \"@material-ui/core/Grid\";\nimport GroupIcon from \"@material-ui/icons/Group\";\nimport Typography from \"@material-ui/core/Typography\";\nimport { makeStyles } from \"@material-ui/core/styles\"; //import Container from \"@material-ui/core/Container\";\n\nimport { Navbar, Nav, NavDropdown, Form, FormControl } from 'react-bootstrap';\nimport 'bootstrap/dist/css/bootstrap.min.css'; //import Logon from \"./Components/Logon\";\n\nimport HomeAdmin from './Components/HomeAdmin';\nconst useStyles = makeStyles(theme => ({\n  paper: {\n    marginTop: theme.spacing(7),\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\"\n  },\n  avatar: {\n    margin: theme.spacing(1),\n    backgroundColor: theme.palette.secondary.main\n  },\n  form: {\n    width: \"100%\",\n    // Fix IE 11 issue.\n    marginTop: theme.spacing(3)\n  },\n  submit: {\n    margin: theme.spacing(3, 0, 2)\n  },\n  textField: {\n    marginLeft: theme.spacing(1),\n    marginRight: theme.spacing(1),\n    width: \"100%\"\n  }\n}));\n\nasync function failedLogon(userId) {\n  const response = await fetch(\"api/user/failedlogon\", {\n    method: \"PUT\",\n    // *GET, POST, PUT, DELETE, etc.\n    mode: \"cors\",\n    // no-cors, *cors, same-origin\n    cache: \"no-cache\",\n    // *default, no-cache, reload, force-cache, only-if-cached\n    credentials: \"same-origin\",\n    // include, *same-origin, omit\n    headers: {\n      \"Content-Type\": \"application/json\" // 'Content-Type': 'application/x-www-form-urlencoded',\n\n    },\n    redirect: \"follow\",\n    // manual, *follow, error\n    referrerPolicy: \"no-referrer\",\n    // no-referrer, *client\n    body: JSON.stringify(userId) // body data type must match \"Content-Type\" header\n\n  });\n}\n\nasync function successLogon(userId) {\n  const response = await fetch(\"api/user/update\", {\n    method: \"PUT\",\n    // *GET, POST, PUT, DELETE, etc.\n    mode: \"cors\",\n    // no-cors, *cors, same-origin\n    cache: \"no-cache\",\n    // *default, no-cache, reload, force-cache, only-if-cached\n    credentials: \"same-origin\",\n    // include, *same-origin, omit\n    headers: {\n      \"Content-Type\": \"application/json\" // 'Content-Type': 'application/x-www-form-urlencoded',\n      //X-Content-Type-Options: no-sniff\n\n    },\n    redirect: \"follow\",\n    // manual, *follow, error\n    referrerPolicy: \"no-referrer\",\n    // no-referrer, *client\n    body: JSON.stringify(userId) // body data type must match \"Content-Type\" header\n\n  });\n}\n\nclass Logon extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      currentPage: \"Login\",\n      username: '',\n      password: '',\n      email: \"\",\n      isLoading: true,\n      hasLoginFailed: false,\n      showSuccessMessage: false,\n      users: [],\n      userid: null,\n      usertype: null,\n      regapproval: null\n    };\n    this.handleChange = this.handleChange.bind(this);\n    this.loginClicked = this.loginClicked.bind(this);\n  }\n\n  handleChange(event) {\n    this.setState({\n      [event.target.name]: event.target.value\n    });\n  }\n\n  loginClicked() {\n    const _this$state = this.state,\n          users = _this$state.users,\n          isLoading = _this$state.isLoading;\n    console.log(users);\n    /*\r\n    {users.map(users =>\r\n      {(this.state.username===users.username||this.state.username===users.email) && this.state.password==users.password?\r\n        this.setState({\r\n          hasLoginFailed:false, \r\n          showSuccessMessage:true,\r\n          username: (users.username),\r\n          userid: (users.pk_user_id),\r\n          usertype: (users.user_type),\r\n          regapproval: users.reg_approval,\r\n          failcount: users.fail_count\r\n        }):    \r\n        this.setState({hasLoginFailed:true})\r\n      } \r\n      )}\r\n      */\n\n    {\n      users.map(users => {\n        {\n          (this.state.username === users.username || this.state.username === users.email) && this.state.password === users.password && this.setState({\n            hasLoginFailed: false,\n            showSuccessMessage: true,\n            username: users.username,\n            userid: users.pk_user_id,\n            usertype: users.user_type,\n            regapproval: users.reg_approval,\n            failcount: users.fail_count\n          });\n        }\n      });\n    }\n    {\n      users.map(users => {\n        {\n          {\n            (this.state.username === users.username || this.state.username === users.email) && this.state.password === users.password && successLogon({\n              pk_user_id: users.pk_user_id,\n              fail_count: 0\n            });\n          }\n        }\n      });\n    }\n    /*\r\n    {\r\n        users.map(users => {\r\n            {\r\n                ((this.state.username === users.username || this.state.username === users.email) && !this.state.password !== users.password) &&\r\n                this.setState({\r\n                    hasLoginFailed: true,\r\n                    failedId: (users.pk_user_id)\r\n                })\r\n            }\r\n          })\r\n    }\r\n    */\n\n    {\n      users.map(users => {\n        {\n          (this.state.username === users.username || this.state.username === users.email) && this.state.password !== users.password && //console.log({ pk_user_id: users.pk_user_id })\n          failedLogon({\n            pk_user_id: users.pk_user_id\n          });\n        }\n      });\n    }\n    /*\r\n    console.log(this.state)\r\n    let userId = {\r\n        pk_user_id: this.state.failedId\r\n    };\r\n    console.log(userId)\r\n    failedLogon(userId);\r\n    */\n  } // set user details to local storage\n\n\n  componentWillUpdate(nextProps, nextState) {\n    localStorage.setItem('user', JSON.stringify(nextState));\n  } //get userlist\n\n\n  async componentDidMount() {\n    const response = await fetch('/api/user/');\n    const body = await response.json();\n    this.setState({\n      users: body,\n      isLoading: false\n    });\n  }\n\n  render() {\n    const _this$state2 = this.state,\n          users = _this$state2.users,\n          isLoading = _this$state2.isLoading;\n\n    if (isLoading) {\n      return React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 235\n        },\n        __self: this\n      }, \"Loading...\");\n    }\n\n    return (//                    {this.state.showSuccessMessage && <div>Login Sucessful for {this.state.username}, user id is {this.state.userid}, user type is {this.state.usertype}</div>}\n      React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 241\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 242\n        },\n        __self: this\n      }, \"Login\"), React.createElement(\"div\", {\n        className: \"container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 243\n        },\n        __self: this\n      }, React.createElement(\"form\", {\n        onSubmit: this.loginClicked,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 244\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"form-group\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 245\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 246\n        },\n        __self: this\n      }, \"Username or Email\"), React.createElement(\"input\", {\n        type: \"text\",\n        name: \"username\",\n        className: \"form-control\",\n        value: this.state.username,\n        onChange: this.handleChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 247\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"form-group\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 249\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 250\n        },\n        __self: this\n      }, \"Password\"), React.createElement(\"input\", {\n        type: \"password\",\n        name: \"password\",\n        className: \"form-control\",\n        value: this.state.password,\n        onChange: this.handleChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 251\n        },\n        __self: this\n      })), this.state.hasLoginFailed && React.createElement(\"div\", {\n        className: \"alert alert-warning\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 253\n        },\n        __self: this\n      }, \"Invalid Credentials\"), this.state.showSuccessMessage && this.state.failcount >= 3 && React.createElement(\"div\", {\n        className: \"alert alert-warning\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 254\n        },\n        __self: this\n      }, \"Locked id\"), this.state.showSuccessMessage && this.state.usertype == 0 && this.state.failcount < 4 && React.createElement(Redirect, {\n        to: \"/homeadmin\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 255\n        },\n        __self: this\n      }), this.state.showSuccessMessage && this.state.usertype == 1 && this.state.failcount < 4 && React.createElement(Redirect, {\n        to: \"/homedonor\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 256\n        },\n        __self: this\n      }), this.state.showSuccessMessage && this.state.usertype == 2 && this.state.failcount < 4 && React.createElement(Redirect, {\n        to: \"/homecharity\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 257\n        },\n        __self: this\n      }), React.createElement(\"button\", {\n        type: \"submit\",\n        className: \"btn btn-primary btn-block\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 258\n        },\n        __self: this\n      }, \"Login\"))))\n    );\n  }\n\n}\n\nclass Login extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      currentPage: \"Login\"\n    };\n  }\n\n  render() {\n    return React.createElement(React.Fragment, null, React.createElement(TopNavBar, {\n      data: this.state,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 285\n      },\n      __self: this\n    }), React.createElement(Logon, {\n      data: this.state,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 286\n      },\n      __self: this\n    }), React.createElement(Footer, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 287\n      },\n      __self: this\n    }));\n  }\n\n}\n\nReactDOM.render(React.createElement(Login, {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 295\n  },\n  __self: this\n}), document.getElementById('root'));\nexport default Login;","map":{"version":3,"sources":["C:/Project/apiset2/frontend/src/Login.js"],"names":["TopNavBar","React","Component","BrowserRouter","Router","Route","Switch","Redirect","ReactDOM","Recipients","HomePageCharities","Container","Footer","Home","Avatar","Button","CssBaseline","TextField","Link","Grid","GroupIcon","Typography","makeStyles","Navbar","Nav","NavDropdown","Form","FormControl","HomeAdmin","useStyles","theme","paper","marginTop","spacing","display","flexDirection","alignItems","avatar","margin","backgroundColor","palette","secondary","main","form","width","submit","textField","marginLeft","marginRight","failedLogon","userId","response","fetch","method","mode","cache","credentials","headers","redirect","referrerPolicy","body","JSON","stringify","successLogon","Logon","constructor","props","state","currentPage","username","password","email","isLoading","hasLoginFailed","showSuccessMessage","users","userid","usertype","regapproval","handleChange","bind","loginClicked","event","setState","target","name","value","console","log","map","pk_user_id","user_type","reg_approval","failcount","fail_count","componentWillUpdate","nextProps","nextState","localStorage","setItem","componentDidMount","json","render","Login","document","getElementById"],"mappings":"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","sourcesContent":["import TopNavBar from './TopNavBar';\r\nimport React, { Component } from \"react\";\r\n//import AddEmployee from \"./Components/AddEmployee\";\r\n//import { Route, BrowserRouter as Router } from \"react-router-dom\";\r\nimport { BrowserRouter, Router, Route, Switch, Redirect } from 'react-router-dom';\r\n//import Table from \"./Components/Table\";\r\n//import App from './App';\r\n//import background from './charitybackground.jfif';\r\nimport ReactDOM from 'react-dom';\r\nimport Recipients from \"./Components/Recipients\";\r\nimport HomePageCharities from './Components/HomePageCharities';\r\nimport { Container } from 'react-bootstrap';\r\nimport Footer from './Footer';\r\nimport Home from './Home';\r\nimport Avatar from \"@material-ui/core/Avatar\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\r\nimport TextField from \"@material-ui/core/TextField\";\r\nimport { Link } from \"react-router-dom\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport GroupIcon from \"@material-ui/icons/Group\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\n//import Container from \"@material-ui/core/Container\";\r\nimport { Navbar, Nav, NavDropdown, Form, FormControl } from 'react-bootstrap'\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\n//import Logon from \"./Components/Logon\";\r\nimport HomeAdmin from './Components/HomeAdmin';\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    paper: {\r\n        marginTop: theme.spacing(7),\r\n        display: \"flex\",\r\n        flexDirection: \"column\",\r\n        alignItems: \"center\"\r\n    },\r\n    avatar: {\r\n        margin: theme.spacing(1),\r\n        backgroundColor: theme.palette.secondary.main\r\n    },\r\n    form: {\r\n        width: \"100%\", // Fix IE 11 issue.\r\n        marginTop: theme.spacing(3)\r\n    },\r\n    submit: {\r\n        margin: theme.spacing(3, 0, 2)\r\n    },\r\n    textField: {\r\n        marginLeft: theme.spacing(1),\r\n        marginRight: theme.spacing(1),\r\n        width: \"100%\"\r\n    }\r\n}));\r\n\r\nasync function failedLogon(userId) {\r\n    const response = await fetch(\"api/user/failedlogon\", {\r\n        method: \"PUT\", // *GET, POST, PUT, DELETE, etc.\r\n        mode: \"cors\", // no-cors, *cors, same-origin\r\n        cache: \"no-cache\", // *default, no-cache, reload, force-cache, only-if-cached\r\n        credentials: \"same-origin\", // include, *same-origin, omit\r\n        headers: {\r\n            \"Content-Type\": \"application/json\"\r\n            // 'Content-Type': 'application/x-www-form-urlencoded',\r\n        },\r\n        redirect: \"follow\", // manual, *follow, error\r\n        referrerPolicy: \"no-referrer\", // no-referrer, *client\r\n        body: JSON.stringify(userId) // body data type must match \"Content-Type\" header\r\n    });\r\n}\r\n\r\nasync function successLogon(userId) {\r\n    const response = await fetch(\"api/user/update\", {\r\n        method: \"PUT\", // *GET, POST, PUT, DELETE, etc.\r\n        mode: \"cors\", // no-cors, *cors, same-origin\r\n        cache: \"no-cache\", // *default, no-cache, reload, force-cache, only-if-cached\r\n        credentials: \"same-origin\", // include, *same-origin, omit\r\n        headers: {\r\n            \"Content-Type\": \"application/json\"\r\n            // 'Content-Type': 'application/x-www-form-urlencoded',\r\n            //X-Content-Type-Options: no-sniff\r\n        },\r\n        redirect: \"follow\", // manual, *follow, error\r\n        referrerPolicy: \"no-referrer\", // no-referrer, *client\r\n        body: JSON.stringify(userId) // body data type must match \"Content-Type\" header\r\n    });\r\n}\r\n\r\nclass Logon extends React.Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            currentPage: \"Login\",\r\n            username: '',\r\n            password: '',\r\n            email: \"\",\r\n            isLoading: true,\r\n            hasLoginFailed: false,\r\n            showSuccessMessage: false,\r\n            users: [],\r\n            userid: null,\r\n            usertype: null,\r\n            regapproval: null\r\n\r\n        }\r\n\r\n\r\n        this.handleChange = this.handleChange.bind(this)\r\n        this.loginClicked = this.loginClicked.bind(this)\r\n    }\r\n\r\n\r\n\r\n    handleChange(event) {\r\n        this.setState(\r\n            {\r\n                [event.target.name]\r\n                    : event.target.value\r\n            }\r\n        )\r\n    }\r\n\r\n    loginClicked() {\r\n\r\n        const { users, isLoading } = this.state;\r\n        console.log(users);\r\n        /*\r\n        {users.map(users =>\r\n          {(this.state.username===users.username||this.state.username===users.email) && this.state.password==users.password?\r\n            this.setState({\r\n              hasLoginFailed:false, \r\n              showSuccessMessage:true,\r\n              username: (users.username),\r\n              userid: (users.pk_user_id),\r\n              usertype: (users.user_type),\r\n              regapproval: users.reg_approval,\r\n              failcount: users.fail_count\r\n            }):    \r\n            this.setState({hasLoginFailed:true})\r\n          } \r\n          )}\r\n          */\r\n        {\r\n            users.map(users => {\r\n                {\r\n                    ((this.state.username === users.username || this.state.username === users.email) && this.state.password === users.password) &&\r\n                    this.setState({\r\n                        hasLoginFailed: false,\r\n                        showSuccessMessage: true,\r\n                        username: (users.username),\r\n                        userid: (users.pk_user_id),\r\n                        usertype: (users.user_type),\r\n                        regapproval: users.reg_approval,\r\n                        failcount: users.fail_count\r\n                    })\r\n                }\r\n            })\r\n        }\r\n\r\n        {\r\n            users.map(users => {\r\n                {\r\n                    {\r\n                        ((this.state.username === users.username || this.state.username === users.email) && this.state.password === users.password) &&\r\n                        successLogon({pk_user_id: users.pk_user_id, fail_count: 0})\r\n                    }\r\n                    \r\n                }\r\n            })\r\n        }\r\n\r\n        \r\n\r\n        /*\r\n        {\r\n            users.map(users => {\r\n                {\r\n                    ((this.state.username === users.username || this.state.username === users.email) && !this.state.password !== users.password) &&\r\n                    this.setState({\r\n                        hasLoginFailed: true,\r\n                        failedId: (users.pk_user_id)\r\n                    })\r\n                }\r\n\r\n            })\r\n        }\r\n        */\r\n\r\n        {\r\n            users.map(users => {\r\n                {\r\n                    ((this.state.username === users.username || this.state.username === users.email) && this.state.password !== users.password) &&\r\n                    //console.log({ pk_user_id: users.pk_user_id })\r\n                    failedLogon({ pk_user_id: users.pk_user_id })\r\n                }\r\n            })\r\n        }\r\n\r\n        /*\r\n        console.log(this.state)\r\n        let userId = {\r\n            pk_user_id: this.state.failedId\r\n        };\r\n        console.log(userId)\r\n        failedLogon(userId);\r\n        */\r\n\r\n    }\r\n\r\n\r\n\r\n    // set user details to local storage\r\n    componentWillUpdate(nextProps, nextState) {\r\n        localStorage.setItem('user', JSON.stringify(nextState));\r\n    }\r\n\r\n\r\n    //get userlist\r\n    async componentDidMount() {\r\n\r\n        const response = await fetch('/api/user/');\r\n        const body = await response.json();\r\n        this.setState({ users: body, isLoading: false });\r\n    }\r\n\r\n\r\n\r\n    render() {\r\n\r\n        const { users, isLoading } = this.state;\r\n\r\n\r\n        if (isLoading) {\r\n            return <p>Loading...</p>;\r\n        }\r\n\r\n        return (\r\n            //                    {this.state.showSuccessMessage && <div>Login Sucessful for {this.state.username}, user id is {this.state.userid}, user type is {this.state.usertype}</div>}\r\n\r\n            <div>\r\n                <h1>Login</h1>\r\n                <div className=\"container\">\r\n                    <form onSubmit={this.loginClicked}>\r\n                        <div className=\"form-group\">\r\n                            <label>Username or Email</label>\r\n                            <input type=\"text\" name=\"username\" className=\"form-control\" value={this.state.username} onChange={this.handleChange} />\r\n                        </div>\r\n                        <div className=\"form-group\">\r\n                            <label>Password</label>\r\n                            <input type=\"password\" name=\"password\" className=\"form-control\" value={this.state.password} onChange={this.handleChange} />\r\n                        </div>\r\n                        {this.state.hasLoginFailed && <div className=\"alert alert-warning\" >Invalid Credentials</div>}\r\n                        {(this.state.showSuccessMessage && this.state.failcount >= 3) && <div className=\"alert alert-warning\">Locked id</div>}\r\n                        {(this.state.showSuccessMessage && this.state.usertype == 0 && this.state.failcount < 4) && <Redirect to=\"/homeadmin\" />}\r\n                        {(this.state.showSuccessMessage && this.state.usertype == 1 && this.state.failcount < 4) && <Redirect to=\"/homedonor\" />}\r\n                        {(this.state.showSuccessMessage && this.state.usertype == 2 && this.state.failcount < 4) && <Redirect to=\"/homecharity\" />}\r\n                        <button type=\"submit\" className=\"btn btn-primary btn-block\">Login</button>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n\r\n        )\r\n    }\r\n}\r\n\r\n\r\n\r\nclass Login extends React.Component {\r\n\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            currentPage: \"Login\"\r\n        };\r\n    }\r\n\r\n\r\n\r\n\r\n    render() {\r\n        return (\r\n            <>\r\n                <TopNavBar data={this.state} />\r\n                <Logon data={this.state} />\r\n                <Footer />\r\n\r\n            </>\r\n        )\r\n    }\r\n}\r\n\r\nReactDOM.render(\r\n    <Login />,\r\n    document.getElementById('root')\r\n);\r\n\r\nexport default Login;\r\n\r\n"]},"metadata":{},"sourceType":"module"}